<html>
<div class="container">
<p id="notice"><%= notice %></p>


<table class="table">
	<h1>Purchaser information</h1>
<p>
  <strong>Name:</strong>
  <%= @order.name %>
</p>

<p>
  <strong>Address:</strong>
  <%= @order.address %>
</p>

<p>
  <strong>Email:</strong>
  <%= @order.email %>
</p>
<p>
  <strong>Order Number:</strong>
     <%= @order.id %>
</p>
<body>
<h2>Listing items for selected purchase </h2>
<table class="table table-striped">

<tr>
        <th data-field="name" class="col-md-4">Name of Dish</th>
        <th data-field="image" class="col-md-4">            
            Image
        </th>
        <th data-field="price" class="col-md-2">
            Price
        </th>
        <th data-field="qty" class="col-md-2">
            Qty
        </th>
        <th data-field="total-price" class="col-md-2">
            Total Price
        </th>

</tr>
<tbody>
<% @menus.each do |menu| %>
	
	<tr>
		<td><%= menu.foodItem %></td>
		<td><%= image_tag(menu.image_url, :width => 80) if menu.image_url.present? %></td>
		<td><%= number_to_currency(menu.price) %></td>
			
		<% @order.line_items.each do |line_item|%>
			<% if (menu.id == line_item.menu_id)%>
				<td><%= line_item.quantity %></td>				
				<td ><%= number_to_currency(line_item.total_price) %></td>				
			<%end%>
		<%end%>
	</tr>

<%end%>
  </body>
</table>
	<p>		
	<b>Total Price: <%= number_to_currency(@order.total_price) %></b>
	</p>
</html>
<br>

<%= link_to 'Edit', edit_order_path(@order) %> |
<%= link_to 'Back', orders_path %>
</div>
<script>
  $(document).ready(function(){
      // page is now ready, initialize the calendar...
      $('#new_event').click(function(event) {
        event.preventDefault();
        var url = $(this).attr('href');
        $.ajax({
          url: url,
          beforeSend: function() {
            $('#loading').show();
          },
          complete: function() {
            $('#loading').hide();
          },
          success: function(data) {
            $('#create_event').replaceWith(data['form']);
            $('#create_event_dialog').dialog({
              title: 'New Event',
              modal: true,
              width: 500,
              close: function(event, ui) { $('#create_event_dialog').dialog('destroy') }
            });
          }
        });
      });
	  
      $('#calendar').fullCalendar({
          editable: true,
          header: {
              left: 'prev,next today',
              center: 'title',
              right: 'month,agendaWeek,agendaDay'
          },
          defaultView: 'month',
          height: 500,
          slotMinutes: 15,
          
          
          events: '/events.json',
         


          timeFormat: 'h:mm t{ - h:mm t} ',
          dragOpacity: "0.5",
          eventDrop: function(event, dayDelta, minuteDelta, allday, revertFunc){
              if (confirm("Are you sure about this change?")) {
                moveEvent(event, dayDelta, minuteDelta, allDay);
              }
              else {
                revertFunc();
              }
          },
          
          eventResize: function(event, dayDelta, minuteDelta, revertFunc){
//              if (confirm("Are you sure about this change?")) {
                  resizeEvent(event, dayDelta, minuteDelta);
//              }
//              else {
//                  revertFunc();
//              }
          },
          
          eventClick: function(event, jsEvent, view){
              showEventDetails(event);
          },
          
          dayClick: function(date, allDay, jsEvent, view){
            if (allDay) {
              alert('Clicked on the entire day: ' + date);
            }
            else{
              alert('Clicked on the slot: ' + date);
            }
          }
          
      });
  }); 
  
</script>
    <script type="text/javascript" src="js/jquery.js"></script><script type="text/javascript" src="js/jquery-easing-1.3.pack.js"></script><script type="text/javascript" src="js/jquery-easing-compatibility.1.2.pack.js"></script>

<div id="eventlist">
<div id= "calendarback">
  <div id="calendar">
  </div>
</div>
</div>
<br />
<br />